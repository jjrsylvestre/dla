<?xml version="1.0" encoding="UTF-8" ?>

<!--********************************************************************
© 2016–2019 Jeremy Sylvestre

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts. A
copy of the license is included in the appendix entitled “GNU Free
Documentation License” that appears in the output document of this
PreTeXt source code. All trademarks™ are the registered® marks of their
respective owners.
*********************************************************************-->


<section xml:id="section-elem-nilpotent-theory">

<title>Theory</title>

<p>
Here, we are most interested in the theory of cyclic subspaces relative to a nilpotent matrix,
but we will start with some general facts.
</p>

<proposition>  <!-- old label \label{PROP::cyclic.is.invariant} -->
	<title>Cyclic is invariant</title>
	<statement><p> Every <m>A</m>-cyclic subspace for a square matrix <m>A</m> is <m>A</m>-invariant. </p></statement>
	<proof><p>
		We have already outlined the justification for this fact in
		<xref ref="subsection-elem-nilpotent-concepts-cyclic" />,
		and we leave the details of a formal proof to you,
		the reader.
	</p></proof>
</proposition>

<lemma xml:id="lemma-elem-nilpotent-cyclic-transition">
	<title>Cyclic basis for cyclic subspace</title>
	<statement><p>
		Suppose <m>A</m> is an <m>n \times n</m> matrix and <m>\uvec{w}</m> is a nonzero <m>n</m>-dimensional vector.
		Then there exists a positive integer <m>k</m> so that
		<me> \{ \uvec{w}, A \uvec{w}, A^2 \uvec{w}, \dotsc, A^{k-1} \uvec{w} \} </me>
		is a basis for the <m>A</m>-cyclic subspace generated by <m>\uvec{w}</m>.
	</p></statement>
	<proof>
		<p>
		A proper proof would require an induction-like argument, but we will argue more informally.
		</p><p>
		The nonzero generating vector <m>\uvec{w}</m> is linearly independent all by itself.
		On the other hand, the collection
		<me> \uvec{w}, A \uvec{w}, A^2 \uvec{w} , \dotsc, A^n \uvec{w} </me>
		must be linearly dependent because it is a collection of <m>n+1</m> vectors in a <m>n</m>-dimensional space
		(<xref ref="lemma-linear-indep-more-than-spanning-is-dep" />).
		So there must be a <q>transition</q> exponent <m>k \le n</m> where
		<me> \uvec{w}, A \uvec{w}, A^2 \uvec{w}, \dotsc, A^{k-1} \uvec{w} </me>
		is independent but
		<me> \uvec{w}, A \uvec{w}, A^2 \uvec{w}, \dotsc, A^k \uvec{w} </me>
		is dependent
		(where we take <m>A^0 \uvec{w}</m> to mean <m>\uvec{w}</m> even if <m>A</m> is not invertible).
		We claim that this transition value <m>k</m> is the one required by the statement of the lemma.
		</p><p>
		Since we already have independence, to verify this claim we only need to demonstrate that
		<me> W' = \Span \{ \uvec{w}, A \uvec{w}, A^2 \uvec{w}, \dotsc, A^{k-1} \uvec{w} \} </me>
		is the same space as the full cyclic subspace
		<me> W = \Span \{ \uvec{w}, A \uvec{w}, A^2 \uvec{w}, \dotsc \} </me>.
		And to do that, it is enough to verify that each of
		<me> A^k \uvec{w}, A^{k+1} \uvec{w}, A^{k+2} \uvec{w}, \dotsc </me>
		is in <m>W'</m>
		(<xref ref="proposition-subspaces-eq-span-test" />).
		</p><p>
		Now, we already know that <m>A^k \uvec{w}</m> must be in <m>W'</m> by its dependence with the finite spanning set for <m>W'</m>.
		If we write
		<me> A^k \uvec{w} = a_0 \uvec{w} + a_1 A \uvec{w} + a_2 A^2 \uvec{w} + \dotsb + a_{k-1} A^{k-1} \uvec{w} </me>,
		then multiplying through by <m>A</m> gives
		<me> A^{k+1} \uvec{w} = a_0 A \uvec{w} + a_1 A^2 \uvec{w} + a_2 A^3 \uvec{w} + \dotsb + a_{k-1} A^k \uvec{w} </me>.
		This expression for <m>A^{k+1} \uvec{w}</m> is a linear combination of vectors in <m>W'</m>,
		and so must be in <m>W'</m> as well
		(<xref ref="proposition-subspaces-props" />).
		Similarly, we can multiply that expression for <m>A^{k+1} \uvec{w}</m> through by <m>A</m> to get an expression for <m>A^{k+2} \uvec{w}</m> as a linear combination of vectors in <m>W'</m>. And similarly for <m>A^{k+3} \uvec{w}</m>,
		and so on.
		</p>
	</proof>
</lemma>

<p>
Even when matrix <m>A</m> is not nilpotent,
if an <m>A</m>-cyclic spanning set terminates in <m>\zerovec</m>,
the preceding spanning vectors must be a basis for that cyclic space.
</p>

<theorem xml:id="theorem-elem-nilpotent-cyclic-basis-terminating-in-zero">
	<statement><p>
		Suppose <m>A</m> is an <m>n \times n</m> matrix and <m>\uvec{w}</m> is an <m>n</m>-dimensional vector so that
		<m>A^\ell \uvec{w} = \zerovec</m> but <m>A^{\ell-1} \uvec{w} \ne \zerovec</m>,
		for some positive integer <m>\ell</m>.
		Then
		<me> \{ \uvec{w}, A\uvec{w}, A^2 \uvec{w}, \dotsc, A^{\ell - 1} \uvec{w} \} </me>
		is a basis for the <m>A</m>-cyclic subspace generated by <m>\uvec{w}</m>.
	</p></statement>
	<proof>
		<p>
		First, we'll use the
		<xref ref="procedure-linear-indep-concepts-test-for-dep-indep" text="title" />
		to verify that
		<me> \{ \uvec{w}, A\uvec{w}, A^2 \uvec{w}, \dotsc, A^{\ell - 1} \uvec{w} \} </me>
		is a linearly independent set.
		So assume
		<me> c_0 \uvec{w} +  c_1 A \uvec{w} + c_2 A^2 \uvec{w} + \dotsb + c_{k-1} A^{k-1} \uvec{w} = \zerovec </me>
		for some unknown scalars <m>c_j</m>.
		Since we have assumed <m>A^\ell \uvec{w} = \zerovec</m>,
		we can also say that <m>A^j \uvec{w} = \zerovec</m> for <m>j \ge \ell</m>.
		Therefore, multiplying the homogeneous vector equation above through by <m>A^{\ell - 1}</m> yields
		<me> c_0 A^{\ell - 1} \uvec{w} = \zerovec </me>.
		But we have also assumed that <m>A^{\ell - 1} \uvec{w} \neq \zerovec</m>,
		so we must have <m>c_0 = 0</m>
		(<xref ref="proposition-abstract-vec-spaces-basic-vec-props-scalar-mul-eq-zero">Rule</xref>
		of <xref ref="proposition-abstract-vec-spaces-basic-vec-props" />),
		and our initial homogeneous vector equation above becomes
		<me> c_1 A \uvec{w} + c_2 A^2 \uvec{w} + \dotsb + c_{k-1} A^{k-1} \uvec{w} = \zerovec </me>.
		We can repeat the argument, multiplying this new equation through by <m>A^{\ell - 2}</m> to obtain
		<me> c_1 A^{\ell - 1} \uvec{w} = \zerovec </me>,
		from which we can conclude that <m>c_1 = 0</m>.
		And so on, until all the coefficients <m>c_j</m> have been shown to be zero,
		which completes the verification of independence.
		</p><p>
		Finally, we know from
		<xref ref="lemma-elem-nilpotent-cyclic-transition" />
		that there is a positive exponent value <m>k</m>
		for which
		<me> \uvec{w}, A\uvec{w}, A^2 \uvec{w}, \dotsc, A^{k - 1} \uvec{w} </me>
		is independent and
		<me> \uvec{w}, A\uvec{w}, A^2 \uvec{w}, \dotsc, A^{k - 1} \uvec{w}, A^k \uvec{w} </me>
		is dependent.
		Since <m>A^\ell \uvec{w} = \zerovec</m> and we have already shown
		<me> \uvec{w}, A\uvec{w}, A^2 \uvec{w}, \dotsc, A^{\ell - 1} \uvec{w} </me>
		to be independent,
		we can conclude that <m>\ell = k</m> and
		<me> \uvec{w}, A\uvec{w}, A^2 \uvec{w}, \dotsc, A^{\ell - 1} \uvec{w} </me>
		is a basis for the <m>A</m>-cyclic subspace generated by <m>\uvec{w}</m>,
		as in <xref ref="lemma-elem-nilpotent-cyclic-transition" />.
		</p>
	</proof>
</theorem>

<p> We can specialize this theorem to the case of a nilpotent matrix. </p>

<corollary xml:id="corollary-elem-nilpotent-cyclic-basis">
	<title>Cyclic basis for nilpotent cyclic subspace</title>
	<statement><p>
		Suppose <m>N</m> is an <m>n \times n</m> nilpotent matrix,
		and let <m>k</m> represent the
		<term><xref ref="definition-elem-nilpotent-degree-nilpotency" text="title" /></term>
		of <m>N</m>.
		Then there exists an <m>N</m>-cyclic subspace of dimension <m>k</m>,
		and there does <em>not</em> exist any <m>N</m>-cyclic subspace of larger dimension.
	</p></statement>
	<proof><p>
		By the definition of
		<term><xref ref="definition-elem-nilpotent-degree-nilpotency" text="title" /></term>,
		we have <m>N^{k-1} \ne \zerovec</m> and <m>N^k = \zerovec</m>.
		We claim there exists a vector <m>\uvec{w}</m> such that <m>N^{k-1} \uvec{w} \ne \zerovec</m>.
		For example, we could take <m>\uvec{w} = \uvec{e}_j</m>,
		the <m>\nth[j]</m> standard basis vector,
		if the <m>\nth[j]</m> column of <m>N^{k-1}</m> is nonzero.
		However, we also have <m>N^k \uvec{w} = \zerovec \uvec{w} = \zerovec</m>.
		Therefore, we can apply <xref ref="theorem-elem-nilpotent-cyclic-basis-terminating-in-zero" />
		to conclude that
		<me> \{ \uvec{w}, N \uvec{w}, \dotsc, N^{k-1} \uvec{w} \} </me>
		is a basis for the <m>N</m>-cyclic subspace generated by <m>\uvec{w}</m>.
		Since this basis has <m>k</m> vectors in it,
		the cyclic space that it spans has dimension <m>k</m>.
		</p><p>
		If <m>\uvec{u}</m> is any other nonzero <m>n</m>-dimensional vector,
		then <m>N^k = \zerovec</m> implies that <m>N^k \uvec{u} = \zerovec</m>,
		and so
		<md>
			<mrow>
				\Span \{ \uvec{u}, N\uvec{u}, N^2 \uvec{u}, \dotsc \}
				\amp =
				\Span \{ \uvec{u}, N \uvec{u}, N^2 \uvec{u}, \dotsc, N^{k-1} \uvec{u}, \zerovec, \zerovec, \dotsc \}
			</mrow><mrow>
				\amp = \Span \{ \uvec{u}, N \uvec{u}, N^2 \uvec{u}, \dotsc, N^{k-1} \uvec{u} \}
			</mrow>
		</md>.
		Therefore, the <m>N</m>-cyclic space generated by <m>\uvec{u}</m> can be spanned by a collection of <m>k</m> vectors,
		which means that the dimension of this space is less than or equal to <m>k</m>
		(<xref ref="proposition-basis-coords-reduce-span-to-basis" />).
		This proves that no other <m>N</m>-cyclic subspace can have dimension greater than <m>k</m>.
	</p></proof>
</corollary>

<p>
In this chapter, we are most interested in the case where <m>k = n</m>.
</p>

<corollary>  <!-- old label \label{COR::max.nilp.max.cyclic.space.min.nullity} -->
	<statement><p>
		If <m>N</m> is an <m>n \times n</m> nilpotent matrix with maximum degree of nilpotency <m>n</m>,
		then <m>\R^n</m> itself (or <m>\C^n</m> itself, as appropriate) is an <m>N</m>-cyclic space.
		Furthermore, <m>\nullity N = 1</m> and <m>\rank N = n - 1</m>.
	</p></statement>
	<proof>
		<p>
		Suppose <m>N</m> has maximum degree of nilpotency <m>n</m>.
		By <xref ref="corollary-elem-nilpotent-cyclic-basis" />,
		there exists an <m>N</m>-cyclic subspace of dimension <m>n</m>.
		However, the only subspace of <m>\R^n</m> of dimension <m>n</m> is <m>\R^n</m>,
		hence <m>\R^n</m> itself is an <m>N</m>-cyclic space,
		as required.
		(Or similarly for <m>\C^n</m> if we are working with complex scalars and vectors.)
		</p><p>
		The statements about the nullity and rank of <m>N</m> follow from the fact that any cyclic basis for <m>\R^n</m> can be used as the columns of a matrix <m>P</m> to obtain
		<me> \inv{P} N P = \begin{bmatrix} 0 \\ 1 \amp 0 \\ \amp \ddots \amp \ddots \\ \amp \amp 1 \amp 0 \end{bmatrix} </me>.
		Similar matrices have the same rank and nullity
		(<xref ref="corollary-similarity-rank-nullity" />),
		so
		<md><mrow>
			\rank N \amp = \rank (\inv{P}NP) = n-1 \text{,} \amp
			\nullity N \amp = \nullity (\inv{P}NP) = 1 \text{.}
		</mrow></md>
	</p></proof>
</corollary>

<remark><p>
	The facts in this section guarantee that, in the case of a nilpotent <m>N</m> with <m>N^{n-1} \ne \zerovec</m>,
	we will be able to successfully carry out
	<xref ref="procedure-elem-nilpotent-concepts-max-nilp-elem-form" />,
	and that the transition matrix <m>P</m> we construct in that procedure will be invertible,
	as its columns will be linearly independent.
</p></remark>

</section>
